{"filter":false,"title":"Item.php","tooltip":"/Portfolio_work/models/Item.php","undoManager":{"mark":15,"position":15,"stack":[[{"start":{"row":144,"column":5},"end":{"row":164,"column":9},"action":"remove","lines":["   // メールアドレスとパスワードを与えられてユーザーを取得","        public static function login($email, $password){","             try {","                $pdo = self::get_connection();","                $stmt = $pdo -> prepare(\"SELECT * FROM users WHERE email=:email AND password=:password\");","                // バインド処理","                $stmt->bindParam(':email', $email, PDO::PARAM_STR);","                 $stmt->bindParam(':password', $password, PDO::PARAM_STR);                // 実行","","                // 実行","                $stmt->execute();","                // フェッチの結果を、Userクラスのインスタンスにマッピングする","                $stmt->setFetchMode(PDO::FETCH_CLASS|PDO::FETCH_PROPS_LATE, 'User');","                $user = $stmt->fetch();","                self::close_connection($pdo, $stmp);","                return $user;","                ","                } catch (PDOException $e) {","                    return 'PDO exception: ' . $e->getMessage();","                }","        }"],"id":2},{"start":{"row":144,"column":4},"end":{"row":144,"column":5},"action":"remove","lines":[" "]},{"start":{"row":144,"column":0},"end":{"row":144,"column":4},"action":"remove","lines":["    "]},{"start":{"row":143,"column":8},"end":{"row":144,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":143,"column":8},"end":{"row":178,"column":9},"action":"remove","lines":["","        // その投稿に紐づいたコメント一覧を取得","        public function comments(){","             try {","                $pdo = self::get_connection();","                $stmt = $pdo -> prepare(\"select comments.id, users.name, comments.content, comments.created_at from comments join users on comments.user_id = users.id where post_id=:post_id\");","                // バインド処理","                $stmt->bindParam(':post_id', $this->id, PDO::PARAM_INT);                // 実行","                $stmt->execute();","                // フェッチの結果を、Commentクラスのインスタンスにマッピングする","                $stmt->setFetchMode(PDO::FETCH_CLASS|PDO::FETCH_PROPS_LATE, 'Comment');","                $comments = $stmt->fetchAll();","                self::close_connection($pdo, $stmp);","                return $comments;","                ","            } catch (PDOException $e) {","                return 'PDO exception: ' . $e->getMessage();","            }","        }","        public function favorites(){","            try {","                $pdo = self::get_connection();","                $stmt = $pdo -> prepare(\"select users.id, users.name from favorites JOIN users ON favorites.user_id = users.id WHERE favorites.post_id=:post_id\");","                // バインド処理","                $stmt->bindParam(':post_id', $this->id, PDO::PARAM_INT);                // 実行","                $stmt->execute();","                // フェッチの結果を、Userクラスのインスタンスにマッピングする","                $stmt->setFetchMode(PDO::FETCH_CLASS|PDO::FETCH_PROPS_LATE, 'User');","                $favorites_users = $stmt->fetchAll();","                self::close_connection($pdo, $stmp);","                return $favorites_users;","                ","            } catch (PDOException $e) {","                return 'PDO exception: ' . $e->getMessage();","            }","        }"],"id":3},{"start":{"row":143,"column":4},"end":{"row":143,"column":8},"action":"remove","lines":["    "]},{"start":{"row":143,"column":0},"end":{"row":143,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":142,"column":9},"end":{"row":143,"column":0},"action":"remove","lines":["",""],"id":4}],[{"start":{"row":131,"column":0},"end":{"row":141,"column":13},"action":"remove","lines":["        public static function destroy($id){","            try {","                $pdo = self::get_connection();","                $stmt = $pdo -> prepare(\"DELETE FROM posts WHERE id=:id\");","                // バインド処理","                $stmt->bindParam(':id', $id, PDO::PARAM_INT);                // 実行","                $stmt->execute();","               ","                } catch (PDOException $e) {","                    return 'PDO exception: ' . $e->getMessage();","            }"],"id":5},{"start":{"row":130,"column":8},"end":{"row":131,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":131,"column":8},"end":{"row":131,"column":9},"action":"remove","lines":["}"],"id":6},{"start":{"row":131,"column":4},"end":{"row":131,"column":8},"action":"remove","lines":["    "]},{"start":{"row":131,"column":0},"end":{"row":131,"column":4},"action":"remove","lines":["    "]},{"start":{"row":130,"column":8},"end":{"row":131,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":3,"column":0},"end":{"row":4,"column":0},"action":"remove","lines":["    require_once 'models/Model.php';",""],"id":7}],[{"start":{"row":63,"column":49},"end":{"row":63,"column":50},"action":"remove","lines":["p"],"id":8}],[{"start":{"row":63,"column":49},"end":{"row":63,"column":50},"action":"insert","lines":["t"],"id":9}],[{"start":{"row":69,"column":9},"end":{"row":70,"column":0},"action":"insert","lines":["",""],"id":10},{"start":{"row":70,"column":0},"end":{"row":70,"column":8},"action":"insert","lines":["        "]}],[{"start":{"row":102,"column":49},"end":{"row":102,"column":50},"action":"remove","lines":["p"],"id":11}],[{"start":{"row":102,"column":49},"end":{"row":102,"column":50},"action":"insert","lines":["t"],"id":12}],[{"start":{"row":123,"column":49},"end":{"row":123,"column":50},"action":"remove","lines":["p"],"id":13}],[{"start":{"row":123,"column":49},"end":{"row":123,"column":50},"action":"insert","lines":["t"],"id":14}],[{"start":{"row":142,"column":49},"end":{"row":142,"column":50},"action":"remove","lines":["p"],"id":15}],[{"start":{"row":142,"column":49},"end":{"row":142,"column":50},"action":"insert","lines":["t"],"id":16}],[{"start":{"row":141,"column":12},"end":{"row":141,"column":16},"action":"remove","lines":["    "],"id":17},{"start":{"row":141,"column":8},"end":{"row":141,"column":12},"action":"remove","lines":["    "]},{"start":{"row":141,"column":4},"end":{"row":141,"column":8},"action":"remove","lines":["    "]},{"start":{"row":141,"column":0},"end":{"row":141,"column":4},"action":"remove","lines":["    "]},{"start":{"row":140,"column":12},"end":{"row":141,"column":0},"action":"remove","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":1800,"scrollleft":0,"selection":{"start":{"row":137,"column":28},"end":{"row":137,"column":28},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":8,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1644124976887,"hash":"cafa5ffc736242f5a6b87c850d02e3132ac4f145"}